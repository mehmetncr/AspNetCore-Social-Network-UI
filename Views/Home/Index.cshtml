@model HomeViewModel
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/LayoutPage.cshtml";
}


<div class="fixed-sidebar right">
    <div class="chat-friendz">
        <partial name="OnlineFriendsPartialView" data="@Model.OnlineFriendsDtos" />
        <div class="chat-box">
            <div class="chat-head">
                <span class="status f-online"></span>
                <h6>Bucky Barnes</h6>
                <div class="more">
                    <span class="more-optns">
                        <i class="ti-more-alt"></i>
                        <ul>
                            <li>block chat</li>
                            <li>unblock chat</li>
                            <li>conversation</li>
                        </ul>
                    </span>
                    <span class="close-mesage"><i class="ti-close"></i></span>
                </div>
            </div>
            <div class="chat-list">
                <ul>
                    <li class="me">
                        <div class="chat-thumb"><img src="images/resources/chatlist1.jpg" alt=""></div>
                        <div class="notification-event">
                            <span class="chat-message-item">
                                Hi James! Please remember to buy the food for tomorrow! I’m gonna be handling the gifts and Jake’s gonna get the drinks
                            </span>
                            <span class="notification-date"><time datetime="2004-07-24T18:18" class="entry-date updated">Yesterday at 8:10pm</time></span>
                        </div>
                    </li>
                    <li class="you">
                        <div class="chat-thumb"><img src="images/resources/chatlist2.jpg" alt=""></div>
                        <div class="notification-event">
                            <span class="chat-message-item">
                                Hi James! Please remember to buy the food for tomorrow! I’m gonna be handling the gifts and Jake’s gonna get the drinks
                            </span>
                            <span class="notification-date"><time datetime="2004-07-24T18:18" class="entry-date updated">Yesterday at 8:10pm</time></span>
                        </div>
                    </li>
                    <li class="me">
                        <div class="chat-thumb"><img src="images/resources/chatlist1.jpg" alt=""></div>
                        <div class="notification-event">
                            <span class="chat-message-item">
                                Hi James! Please remember to buy the food for tomorrow! I’m gonna be handling the gifts and Jake’s gonna get the drinks
                            </span>
                            <span class="notification-date"><time datetime="2004-07-24T18:18" class="entry-date updated">Yesterday at 8:10pm</time></span>
                        </div>
                    </li>
                </ul>
                <form class="text-box">
                    <textarea placeholder="Post enter to post..."></textarea>
                    <div class="add-smiles">
                        <span title="add icon" class="em em-expressionless"></span>
                    </div>
                    <div class="smiles-bunch">
                        <i class="em em---1"></i>
                        <i class="em em-smiley"></i>
                        <i class="em em-anguished"></i>
                        <i class="em em-laughing"></i>
                        <i class="em em-angry"></i>
                        <i class="em em-astonished"></i>
                        <i class="em em-blush"></i>
                        <i class="em em-disappointed"></i>
                        <i class="em em-worried"></i>
                        <i class="em em-kissing_heart"></i>
                        <i class="em em-rage"></i>
                        <i class="em em-stuck_out_tongue"></i>
                    </div>
                    <button type="submit"></button>
                </form>
            </div>
        </div>
    </div>
</div><!-- right sidebar user chat -->


<section>
    <div class="gap2 gray-bg">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">
                    <div class="row merged20" id="page-contents">
                        <div class="col-lg-3">
                            <aside class="sidebar static left">
                                <!--ShortCuts-->
                                <partial name="ShortCutsPartialView" />
                                <!--ShortCuts-->

                            </aside>
                        </div><!-- sidebar -->
                        <div class="col-lg-6">
                            <!--New Post Form-->

                            <vc:new-post></vc:new-post>
                            <!--New Post Form-->
                            <div class="loadMore">
                                <partial name="PostsPartialView" data="@Model.PostDtos" />
                            </div>
                        </div><!-- centerl meta -->
                        <div class="col-lg-3">
                            <aside class="sidebar static right">

                                <div class="widget stick-widget">
                                    <h4 class="widget-title">Önerilen Arkadaşlar</h4>
                                    <ul class="followers">
                                        @foreach (var offeruser in Model.OfferUserDtos)
                                        {
                                            <li>
                                                <figure><img src="@offeruser.UserProfilePicture" alt=""></figure>
                                                <div class="friend-meta">
                                                    <h4><a asp-controller="Profile" asp-action="OtherProfile" asp-route-id="@offeruser.UserId" title="">@offeruser.UserFirstName @offeruser.UserLastName</a></h4>
                                                    <a href="#" title="" class="underline">Arkadaş Ekle</a>
                                                </div>
                                            </li>
                                        }

                                    </ul>
                                </div><!-- who's following -->

                            </aside>
                        </div><!-- sidebar -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script>

        function postLike(postId, likeCount) {
            var likeIcon = $(`#likeIcon${postId}`);
            var likeCountElement = $(`#like${postId}`);

            $.ajax({
                type: "POST",
                url: "/Post/PostLike/",
                data: { postId: postId },
                success: function (result) {
                    console.log(likeIcon);
                    if (parseInt(result) > parseInt(likeCount)) {
                        // Kullanıcı daha önce beğendiği durumu kontrol et
                        likeIcon.removeClass("ti-heart"); // Beğenilmemiş durumu için sınıfı kaldır
                        likeIcon.addClass("fa fa-heart"); // Beğenilmiş durumu için sınıfı ekle
                    }
                    else {
                        // Kullanıcı daha önce beğendiği bir gönderiyi beğeniyi geri alır
                        likeIcon.removeClass("fa fa-heart"); // Beğenilmiş durumu için sınıfı kaldır
                        likeIcon.addClass("ti-heart"); // Beğenilmemiş durumu için sınıfı ekle
                    }
                },
                error: function () {
                    // Hata durumunda yapılacak işlemler
                }
            });
        }

        function postDislike(postId) {
            $.ajax({
                type: "POST",
                url: "/Post/PostLike/",
                data: { postId: postId },
                success: function (result) {
                    // Beğeni sayısını güncelle
                    $("#likeCount").html(result);
                },
                error: function () {

                }
            });
        }

        function replyToComment(commentId, commentContent, firstName, lastName, postId, commentContentUniqKey, commentUserUniqKey, parentCommentUniqKey, replyArea) {
            // Yanıtlanan yorumun içeriğini ve ID'sini form içine ekleyin
            var relpyToArea = document.getElementById(replyArea);
            if (relpyToArea.style.display === "none") {
                relpyToArea.style.display = "block";
            }
            $(`#${commentContentUniqKey}`).text(commentContent);
            var commentUserElementId = "replyToCommentUser" + postId;
            $(`#${commentUserUniqKey}`).text('Cevap Veriliyor: ' + firstName + ' ' + lastName);
            $(`#${parentCommentUniqKey}`).val(commentId);

            // Formun görünürlüğünü sağlayın (gerekirse)
            // Örneğin: $('#addcomment2').show();
        }
        function closeReplyToArea(replyArea, parentCommentUniqKey) {
            var replyToArea = document.getElementById(replyArea);
            if(replyToArea.style.display === "block"){
                replyToArea.style.display = "none";
                $(`#${parentCommentUniqKey}`).val("");
            }
        }

        function youtube() {
            var input = document.getElementById("youtube-input");
            if (input.style.display === "none") {
                input.style.display = "block";
            }
            else {
                input.style.display = "none";
            }
        }
        document.getElementById('fileInput').addEventListener('change', function () {
            var uploadAnimation = document.getElementById('uploadAnimation');
            var postButton = document.getElementById('postButton');

            // Dosya yükleme simülasyonu (Gerçek bir yükleme işlemi için sunucu tarafı kodu eklenmelidir)
            uploadAnimation.style.display = 'block';
            setTimeout(function () {
                uploadAnimation.style.display = 'none';
                postButton.removeAttribute('disabled');
            }, 2000); // 2 saniye sonra simülasyonu tamamla
        });

    </script>
   

}


